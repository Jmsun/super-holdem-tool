<!doctype html>
<html>
<meta charset="utf-8">
<title>Speak</title>
<script>
function get(p){return new URL(location.href).searchParams.get(p)||""}
function speak(){
  const text = decodeURIComponent(get("t")||"");
  const lang = get("lang") || "zh-CN";     // 中文：zh-CN，英文：en-US
  const rate = parseFloat(get("rate")||"1"); // 语速 0.5~2
  const pitch= parseFloat(get("pitch")||"1"); // 音调 0~2
  if(!text){return}
  const u = new SpeechSynthesisUtterance(text);
  u.lang = lang; u.rate = rate; u.pitch = pitch;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}
window.addEventListener("load", ()=> {
  // 某些移动端需要一次用户点击后才能播报；我们尽量自动+兜底按钮
  try { speak(); } catch(e) {}
  document.body.innerHTML = `<button style="font-size:18px;padding:10px 16px" onclick="speak()">🔊 播放/重播</button>`;
});
</script>
<body style="display:flex;justify-content:center;align-items:center;height:100vh;background:#fafafa"></body>
</html>
